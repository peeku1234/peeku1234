package org.example;

public class GenerateReferenceNo {
    public static void main(String[] args) {
        GenerateReferenceNo generateReferenceNo = new GenerateReferenceNo();
        System.out.println(generateReferenceNo.generateReferenceNo("FEE"));
    }

    public String generateReferenceNo(String transactionName) {
        String sequenceName;
        String refCode;
        String refNo = null;
        String nextValue;
        if ("FEE".equals(transactionName)) {
            refCode = "CU";
        } else if ("SARALMTOPUP".equals(transactionName)) {
            refCode = "CV";
        } else {
            refCode = transactionName.trim();
        }
        sequenceName = "R" + refCode + "REF.nextval";
        String sql = "SELECT " + sequenceName + " FROM dual";
        nextValue = "null";
        if (refCode.matches("CK|IU|CR")) {
            refNo = refCode + (char) Integer.parseInt(nextValue.substring(0, 2))
                    + nextValue.substring(2);
        } else if (refCode.matches("CX|CN|CI|CT")) {
            long numericValue = Long.parseLong(nextValue);
            long floorValue = numericValue / 10;
            String alphaNumRef = alphaNumRefNo(floorValue);
            refNo = refCode + String.format("%07d", Long.parseLong(alphaNumRef))
                    + nextValue.substring(nextValue.length() - 1);
        } else {
            refNo = refCode + String.format("%08d", Long.parseLong(nextValue));
        }
        return refNo;
    }

    private String alphaNumRefNo(long seqNo) {
        long modValue = seqNo % 26;
        long divValue = seqNo / 26;
        String retValue;
        if (modValue == 0) {
            modValue = 26;
            divValue--;
        }
        if (divValue >= 1) {
            retValue = alphaNumRefNo((long) Math.floor(divValue)) + (char) (64 + modValue);
        } else {
            retValue = String.valueOf((char) (64 + modValue));
        }
        return retValue;
    }
}
